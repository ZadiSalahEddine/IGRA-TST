import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.neighbors import KNeighborsClassifier
from sklearn.metrics import accuracy_score
from sklearn.metrics import confusion_matrix

dataset = pd.read_csv('C:/Users/NSC/Desktop/a.csv',delimiter=';')

df=pd.DataFrame(dataset)

X=df[['GROUPE','IFNG874','UNSTIMULATED_IFNY_PGML','PHA_IFNY_PGML','AG_IFNY_PGML','CD3_NUMBER','PHA_NORMALIZED',
      'AG_NORMALIZED','TST_RESULT','SEX','AGE','ETHNIC_BACKGROUND']]         #Separation of attributes


Y=df[['IGRA_RESULT']]                            #Separation of classe

#X.info()

#Prepare data for classification process
x_train, x_test, y_train, y_test = train_test_split(X, Y, test_size=0.2, random_state=1,stratify = Y)
#Create a model
KNN_Classifier = KNeighborsClassifier(n_neighbors = 19, p = 1, metric='minkowski')
KNN_Classifier.fit(x_train,y_train.values.ravel())
pred_test = KNN_Classifier.predict(x_test)
#check the accuracy of your predicted classifier
acc = accuracy_score(y_test, pred_test)
acc
